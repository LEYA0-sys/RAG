INFO:root:日志系统已初始化
INFO:datasets:PyTorch version 2.6.0 available.
d:\desktop\code\test.py:10: LangChainDeprecationWarning: The class `HuggingFaceBgeEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  embeddings = HuggingFaceBgeEmbeddings(
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-zh-v1.5
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
INFO:faiss:Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
['什么是宏利环球货币保障计划？', '保单的身故赔偿如何计算？', '保单支持哪些货币？', '如何行使终期红利锁定权益？']
['这是一款分红型终身人寿保险计划，提供身故赔偿、意外身故赔偿及现金价值积累功 能，支持多币种转换，并包含终期红利等非保证利益。', '身故赔偿为以下两者的较高者：(a) 表格所示现金价值 + 终期红利（如有）；或 (b) 所 有已缴保费总和。若受保人在首5年内意外身故，还可额外获得意外身故赔偿（上限为125, 000美元或等值货币）。', '支持美元、港币、人民币、澳元、加元、英镑、新加坡元等，且可从第3个保单周年日 起申请货币转换。', '从第15个保单周年日起，保单持有人可申请将终期红利的最高50%锁定为累积已锁定终 期红利，需在31日内提交书面申请，锁定后不可撤回']
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cpu
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-base-zh-v1.5
Evaluating:   0%|                                                                                  | 0/4 [00:00<?, ?it/s]
Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.42it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.37it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 18.45it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 10.25it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 17.43it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.45it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.45it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 18.35it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 10.11it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 18.32it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 10.23it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 17.24it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.61it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.57it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 18.08it/s]
Evaluating:  25%|##################5                                                       | 1/4 [00:01<00:03,  1.30s/it]
Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.53it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.48it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 14.84it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.74it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.68it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 15.61it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.19it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.13it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 15.72it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.87it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.87it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 15.29it/s]
Evaluating:  50%|#####################################                                     | 2/4 [00:02<00:02,  1.08s/it]
Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 13.01it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 22.79it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  8.08it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  8.08it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 23.20it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 13.77it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 22.43it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 11.98it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 23.61it/s]
Evaluating:  75%|#######################################################5                  | 3/4 [00:02<00:00,  1.13it/s]
Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  6.85it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  6.85it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 18.22it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.25it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.19it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 18.13it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  6.86it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  6.81it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 15.65it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  4.97it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  4.95it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 15.67it/s]
Evaluating: 100%|##########################################################################| 4/4 [00:03<00:00,  1.07it/s]Evaluating: 100%|##########################################################################| 4/4 [00:03<00:00,  1.03it/s]

Average Precision: 0.5833
Average Recall: 0.7500

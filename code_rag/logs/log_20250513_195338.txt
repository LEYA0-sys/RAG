INFO:root:Êó•ÂøóÁ≥ªÁªüÂ∑≤ÂàùÂßãÂåñ
INFO:datasets:PyTorch version 2.6.0 available.
d:\desktop\code\test.py:10: LangChainDeprecationWarning: The class `HuggingFaceBgeEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  embeddings = HuggingFaceBgeEmbeddings(
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-large-zh-v1.5
INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
INFO:faiss:Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cpu
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-base-zh-v1.5
Evaluating:   0%|                                                                                  | 0/4 [00:00<?, ?it/s]
Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.55it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.55it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 18.27it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 10.35it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 18.38it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.58it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.55it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 17.69it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 10.13it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 18.90it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 10.49it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 18.79it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.70it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.64it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 18.17it/s]
Evaluating:  25%|##################5                                                       | 1/4 [00:01<00:03,  1.28s/it]
Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.92it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.92it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 15.06it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  8.02it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.96it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 15.76it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.07it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.07it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 15.57it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.84it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.84it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 15.46it/s]
Evaluating:  50%|#####################################                                     | 2/4 [00:02<00:02,  1.06s/it]
Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 12.90it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 23.89it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  8.12it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  8.12it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 22.40it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 14.57it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 24.24it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 13.11it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 21.33it/s]
Evaluating:  75%|#######################################################5                  | 3/4 [00:02<00:00,  1.15it/s]
Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  6.91it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  6.91it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 18.74it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.33it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  7.33it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 17.99it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  8.49it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  8.41it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 18.64it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][A
Batches: 100%|#############################################################################| 1/1 [00:00<00:00,  6.81it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00,  6.81it/s]

Batches:   0%|                                                                                     | 0/1 [00:00<?, ?it/s][ABatches: 100%|#############################################################################| 1/1 [00:00<00:00, 18.58it/s]
Evaluating: 100%|##########################################################################| 4/4 [00:03<00:00,  1.14it/s]Evaluating: 100%|##########################################################################| 4/4 [00:03<00:00,  1.07it/s]

Average Precision: 0.5833
Average Recall: 0.7500

Results saved to retrieval_results.json
